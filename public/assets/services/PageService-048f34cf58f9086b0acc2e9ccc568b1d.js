"use strict";angular.module("yiftee.services").factory("pageService",["$http","$q",function(e,n){var a={},r=n.defer();return a.initPromise=r.promise,a.sendMessage=function(n,a){return e({url:"/programming_challenge/send",method:"POST",data:{recipients:n,message:a}})},a.autocomplete=function(){var e=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.obj.whitespace("name"),queryTokenizer:Bloodhound.tokenizers.whitespace,remote:{url:"/programming_challenge/autocomplete?q=%QUERY",filter:function(e){var n=e.response.query,a=$("#recipients").tagsinput("items");return $.map(e.response.contacts,function(e){if(e.name.toLowerCase().indexOf(n)>=0){var r=[];return $.inArray(e.email,a)<0&&r.push({value:e.email,name:e.name}),$.inArray(e.phone,a)<0&&r.push({value:e.phone,name:e.name}),r}var r=[];return e.email.toLowerCase().indexOf(n)>=0&&$.inArray(e.email,a)<0&&r.push({value:e.email,name:e.name}),e.phone.toLowerCase().indexOf(n)>=0&&$.inArray(e.phone,a)<0&&r.push({value:e.phone,name:e.name}),r})}}});e.initialize(),$("#recipients").tagsinput({typeaheadjs:{name:"contacts",nameKey:"name",valueKey:"value",source:e.ttAdapter(),templates:{suggestion:Handlebars.compile("<p><strong>{{name}}</strong> \u2013 {{value}}</p>")}}})},a.addContact=function(n){var a=n.item;return e({url:"/programming_challenge/add",method:"POST",data:{contact:a}})},a}]);